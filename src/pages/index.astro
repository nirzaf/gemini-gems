---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import GemCard from "../components/GemCard.astro";

import SearchFilter from "../components/SearchFilter.astro";

// Fetch all gems from the content collection
const gems = await getCollection("gems");

// Get unique categories
const categories = [...new Set(gems.map((gem) => gem.data.category))].sort();
---

<Layout>
  <Header />

  <!-- Stats Section -->
  <section class="py-8 bg-[#0f1419] transition-colors duration-300">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-3 gap-4 text-center max-w-4xl mx-auto">
        <div
          class="stats-card p-5 rounded-xl shadow-sm hover:shadow-md transition-shadow"
        >
        <div
          class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-blue-400 to-cyan-400 bg-clip-text text-transparent mb-2"
        >
            {gems.length}
          </div>
          <div class="text-gray-400 font-semibold text-sm">Gems</div>
        </div>
        <div
          class="stats-card p-5 rounded-xl shadow-sm hover:shadow-md transition-shadow"
        >
        <div
          class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-teal-400 to-emerald-400 bg-clip-text text-transparent mb-2"
        >
            {categories.length}
          </div>
          <div class="text-gray-400 font-semibold text-sm">Categories</div>
        </div>
        <div
          class="stats-card p-5 rounded-xl shadow-sm hover:shadow-md transition-shadow"
        >
        <div
          class="text-3xl md:text-4xl font-bold bg-gradient-to-r from-slate-400 to-gray-400 bg-clip-text text-transparent mb-2"
        >
            100%
          </div>
          <div class="text-gray-400 font-semibold text-sm">Open Source</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Gems Section -->
  <section
    id="gems"
    class="py-12 bg-[#0f1419] min-h-screen transition-colors duration-300"
  >
    <div class="container mx-auto px-4">
      <div class="text-center mb-8">
        <h2 class="text-3xl md:text-4xl font-bold mb-3 text-white">
          Discover Your Perfect AI Persona
        </h2>
        <p class="text-base md:text-lg max-w-2xl mx-auto text-gray-400">
          Browse specialized gems and find your perfect AI assistant.
        </p>
      </div>

      <!-- Search & Filters -->
      <SearchFilter categories={categories} initialCount={gems.length} />

      <!-- Gems Grid -->
      <div
        id="gemsGrid"
        class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6"
      >
        {gems.map((gem) => <GemCard gem={gem} />)}
      </div>
    </div>
  </section>

  <Footer />
</Layout>
